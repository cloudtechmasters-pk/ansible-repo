---
 - hosts: group1
   vars:
        tomcat_download_url: https://mirrors.estointernet.in/apache/tomcat/tomcat-9/v9.0.37/bin/apache-tomcat-9.0.37.tar.gz
        tomcat_download_directory: /opt
   tasks:
     - name : Install java
       yum:
         name: java-1.8.0-openjdk
         state: present
     - name: Print variables
       debug:
         msg: "{{ tomcat_download_url }}"
     - name: Download Apache Tomcat 9
       get_url:
         url: "{{ tomcat_download_url }}"
         dest: "{{ tomcat_download_directory }}"
         mode: '0777'
     - name: unarchive Apache tomcat
       unarchive:
         src: "{{ tomcat_download_directory }}/apache-tomcat-9.0.37.tar.gz"
         dest: "{{ tomcat_download_directory }}"
         remote_src: yes
     - name: Create Tomcat user and Group
       user:
         name: tomcat
         comment: user for tomcat
     - name: Change owner ship for tomcat
       file:
         path: /opt/apache-tomcat-9.0.37
         state: directory
         recurse: yes
         owner: tomcat
         group: tomcat
         mode: '0755'
     - name: Copy Tomcat service from local to remote
		copy:
		   src: /root/tomcat.service
		   dest: /etc/systemd/system/
		   mode: 0755

	  - name: Start and enable Tomcat service
		systemd:
		  name: tomcat
		  state: started
		  enabled: true
		  daemon_reload: true
